---
title: TanStack-Query ë€ ?
description: TanStack-Queryë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ì™€ ì„¤ì¹˜ ë° ê¸°ë³¸ ì‚¬ìš©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.
date: 2023-11-24
tags:
  - React
  - React-Query
image: /img/react/react-query.jpg
---

<p align="center">
  <img src="/img/react/react-query.jpg" alt="react-query" width="500"/>
</p>

# React-Queryë€ ?
React-QueryëŠ” ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ê³  ìºì‹±ì§€ì›ê¹Œì§€ í•´ì£¼ë©´ì„œ ë¹„ë™ê¸° ë°ì´í„°ë¥¼ ì‰½ê²Œ ì²˜ë¦¬í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

> React-Queryë¥¼ ì‚¬ìš©í•˜ëŠ” ê°€ì¥ í° ì´ìœ âœ¨  
> ê°€ì¥ í° ì´ìœ ëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ê°€ ì–¸ì œë‚˜ ìµœì‹ ì˜ ìƒíƒœë¼ê³  í•  ìˆ˜ ì—†ë‹¤. React-Queryë¥¼ ì‚¬ìš©í•˜ë©´ ìµœì‹ ì˜ ë°ì´í„°ë¥¼ ê°„í¸í•˜ê²Œ ìœ ì§€ í•  ìˆ˜ ìˆë‹¤.

# ì„¤ì¹˜ ë° ì…‹íŒ…
```
npm install @tanstack/react-query
```
main.tsx
```jsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'
import './index.css'
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <App />
    </QueryClientProvider>
  </React.StrictMode>,
)
```

# useQuery
useQueryëŠ” ë°ì´í„°ë¥¼ getí•  ë•Œ ì‚¬ìš©í•œë‹¤.

```jsx
import { useQuery } from "@tanstack/react-query";
import PostDelete from "./PostDelete";

const getPosts = async () => {
  try {
    const response = await fetch('https://jsonplaceholder.typicode.com/posts');
    const data = await response.json();
    return data;
  } catch (error) {
    throw new Error(error);
  }
};

export default function App() {
  const { isLoading, error, data, isFetching } = useQuery({
    queryKey: ['posts'],
    queryFn: getPosts
  });

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>Error</div>;

  return (  
    <div>
      {data.map((post) => (
        <li key={post.id}>
          <div>{post.title}</div>
          <PostDelete id={post.id}/>
        </li>
      ))}
    </div>
  );
}
```

* queryKey: ì¿¼ë¦¬ë¥¼ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê³ , ìºì‹±í•˜ê³ , ê³µìœ í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤. ë°°ì—´ì´ì–´ì•¼ í•˜ë©°, ì–´ëŸ¬ ë¬¸ìì—´ ë° ì¤‘ì²© ê°œì²´ì˜ ë°°ì—´ì²˜ëŸ¼ ë³µì¡í•  ìˆ˜ë„ ìˆë‹¤.
* queryFn: promiseë¥¼ ë°˜í™˜í•˜ëŠ” ëª¨ë“  í•¨ìˆ˜ê°€ ê°€ëŠ¥í•˜ë‹¤. promiseëŠ” ë°ì´í„°ë¥¼ í•´ê²°í•˜ê±°ë‚˜ ì˜¤ë¥˜ë¥¼ throwí•´ì•¼í•œë‹¤.

> ğŸ‘‰ useQueryë¥¼ ì‚¬ìš©í•˜ë©´ ì„œë²„ì—ì„œ ë¹„ë™ê¸° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ ê°„ì†Œí™”í•  ìˆ˜ ìˆë‹¤.  
useQueryëŠ” ìºì‹±, ìƒíƒœ ê´€ë¦¬, ì¬ì‹œë„, ë¡œë”©, ì—ëŸ¬ ë“±ì˜ ì‘ì—…ì„ ì²˜ë¦¬í•´ì£¼ì–´ ë³„ë„ë¡œ ì½”ë“œë¥¼ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ë˜ê¸° ë•Œë¬¸ì— ê°œë°œìì—ê²Œ í¸ë¦¬í•¨ì„ ì œê³µí•´ ì¤€ë‹¤.

# useMutation
useMutationì€ get ìš”ì²­ ì´ì™¸ì— ëª¨ë“  ì‘ì—…(post,patch,delete ë“±)ì„ ìš”ì²­ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

```jsx
import axios from 'axios';
import { useMutation, useQueryClient } from '@tanstack/react-query';

async function commentDelete(id) {
  const response = await axios.delete(`https://jsonplaceholder.typicode.com/posts/${id}`);
  return response.data
}

const PostDelete = ({id}) => {
  const queryClient = useQueryClient();

  const DeleteMutation = useMutation({
    mutationFn: commentDelete,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["posts"] }); // íŠ¹ì • í‚¤(key)ì— í•´ë‹¹í•˜ëŠ” ì¿¼ë¦¬ì˜ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë° ì‚¬ìš©
    },
    onError: (error) => {
      console.log(error)
    },
  });

  return (
    <button onClick={() => DeleteMutation.mutate(id)}>
      ì‚­ì œ
    </button>
  )
}

export default PostDelete

```

* mutationFn: ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê³  ì—…ë°ì´íŠ¸í•˜ê³  ì‚­ì œí•˜ëŠ”ë° ì‚¬ìš©í•  í•¨ìˆ˜ promiseë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤.
* onSuccess: ì„±ê³µí–ˆì„ë•Œ ì‹¤í–‰í•  ì½œë°± í•¨ìˆ˜
* onError: ì‹¤íŒ¨í–ˆì„ë•Œ ì‹¤í–‰í•  ì½œë°± í•¨ìˆ˜

> ì°¸ê³   
https://tanstack.com/query/latest/docs/react/overview